<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Supabase Simple</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .success {
            color: green;
        }

        .error {
            color: red;
        }

        .info {
            color: blue;
        }

        button {
            padding: 10px 20px;
            margin: 10px 0;
            background: #722F37;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        input {
            padding: 10px;
            margin: 10px 0;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .log {
            background: #f5f5f5;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            white-space: pre-wrap;
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>üß™ Test Supabase Simple</h1>

        <div id="status" class="info">Inicializando...</div>

        <div>
            <h3>Test de Magic Link:</h3>
            <input type="email" id="email" placeholder="Ingresa tu email" value="test@example.com">
            <button onclick="testMagicLink()">Enviar Magic Link</button>
            <div id="result" class="log"></div>
        </div>

        <div>
            <h3>Logs:</h3>
            <div id="logs" class="log"></div>
        </div>
    </div>

    <script>
        // Configuraci√≥n de Supabase - PROYECTO TEMPORAL
        const SUPABASE_URL = 'https://your-project.supabase.co'  // CAMBIAR POR TU URL
        const SUPABASE_ANON_KEY = 'your-anon-key'  // CAMBIAR POR TU KEY

        let logs = []

        function log(message) {
            const timestamp = new Date().toLocaleTimeString()
            const logMessage = `[${timestamp}] ${message}`
            logs.push(logMessage)
            document.getElementById('logs').textContent = logs.join('\n')
            console.log(logMessage)
        }

        async function testMagicLink() {
            const email = document.getElementById('email').value
            if (!email) {
                log('‚ùå Por favor ingresa un email')
                return
            }

            log('üîÑ Enviando Magic Link...')

            try {
                // Cargar Supabase
                const { createClient } = await import('https://cdn.skypack.dev/@supabase/supabase-js@2')

                // Crear cliente
                const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
                    auth: {
                        redirectTo: window.location.origin + '/auth/callback'
                    }
                })

                log('‚úÖ Cliente Supabase creado')

                // Enviar Magic Link
                const { error } = await supabase.auth.signInWithOtp({
                    email,
                    options: {
                        emailRedirectTo: window.location.origin + '/auth/callback'
                    }
                })

                if (error) {
                    log(`‚ùå Error: ${error.message}`)
                    document.getElementById('result').textContent = `Error: ${error.message}`
                    document.getElementById('result').className = 'error'
                } else {
                    log('‚úÖ Magic Link enviado exitosamente')
                    document.getElementById('result').textContent = '‚úÖ Magic Link enviado exitosamente. Revisa tu email.'
                    document.getElementById('result').className = 'success'
                }

            } catch (error) {
                log(`‚ùå Error inesperado: ${error.message}`)
                document.getElementById('result').textContent = `Error inesperado: ${error.message}`
                document.getElementById('result').className = 'error'
            }
        }

        // Inicializar
        document.addEventListener('DOMContentLoaded', function () {
            log('üöÄ P√°gina cargada')
            log('‚ö†Ô∏è IMPORTANTE: Necesitas configurar tu proyecto de Supabase')
            log('1. Ve a https://supabase.com')
            log('2. Crea un nuevo proyecto')
            log('3. Copia la URL y clave an√≥nima')
            log('4. Actualiza las variables SUPABASE_URL y SUPABASE_ANON_KEY')
        })
    </script>
</body>

</html>